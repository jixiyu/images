> 密码学和共识算法  
> 2018年11月7日09:58:39     
> 12 篇  

### 对称加密——DES


----------


### 1. 加密算法

现代密码学体系中，从加密算法本身角度出发主要分为两大类：**对称加密（symmetric cryptography）**和**非对称加密（asymmetric cryptography）**，又被称作**单钥加密（private key cryptography**和 **双钥加密（public key cryptography）**。


----------
### 2.对称加密
对称加密是指 加密 和解密 使用同一个密钥，通俗点来说就是一把钥匙开一把锁，所以保护好这把钥匙就尤为重要了。就像防盗门一样，门再坚固，如果钥匙丢了或者被人偷偷复制了一把，那还是可以被人轻而易举的闯入的。

常用的对称加密算法有:**DES、3DES、AES**


----------
### 3.DES简介
Date Encipher  Standard,该算法在美国NSA（国家安全局）资助下由IBM公司开发，主要由W. Tuchman 和 C. Meyer 负责在1971-1972年研发成功。其初衷是为政府非机密的敏感信息提供较强的加密保护。它是美国政府担保的第一种加密算法。

DES算法1975年3月公开发表，1977年1月15日由美国国家标准局颁布为数据加密标准（Data Encryption Standard），于1977年7月15日生效并在1977年被正式作为美国联邦信息处理标准。DES首次被批准使用五年，并规定每隔五年由美国国家保密局作出评估，并重新批准它是否继续作为联邦加密标准。

最近的一次评估是在1994年1月，美国已决定1998年12月以后将不再使用DES。因为按照现有的技术水平，采用不到几十万美元的设备，就可破开DES密码体制。估计按照现有的计算水平，破译的成本就更低了。
  
----------
### 4.加密与解密

DES是一种将64比特的明文加密成64比特的密文的对称密码算法，他的密钥长度是56比特。

尽管DES的密钥长度是64比特，但是由于每隔7比特会设置成一个用于错误检查的比特，因此实质上其密钥长度是56比特。

DES是以64比特的明文为一个单位来进行加密的，这个64比特的单位称为**分组**。

一般来说，以分组为单位进行处理的密码算法称为称为**分组密码(block cipher)**。DES就是分组密码的一种。


DES每次只能加密64比特的数据，如果要加密的明文比较长，就需要对DES加密进行迭代，二迭代的具体方式就成为**模式(mode)**.

<img src="https://www.github.com/jixiyu/images3/raw/master/小书匠/1541557686265.png" width="500" hegiht="500" align="center" /> 

----------
### 5.DES特点

1. 对称算法：加密和解密使用同一秘钥

2. 分组加密算法：以64位为分组。64位明文输入，64位密文输出。

3. 有效秘钥长度为56位秘钥通常表示为64位数，但每个第8位用作奇偶校验，可以忽略。

4. 代替和置换DES算法是两种加密技术的组合：混乱和扩散。先替代后置换。

5. 易于实现：DES算法只是使用了标准的算术和逻辑运算，其作用的数最多也只有64 位，因此用70年代末期的硬件技术很容易实现算法的重复特性使得它可以非常理想地用在一个专用芯片中。

6. 可通过多重加密，提高安全等级



----------
### 6.算法描述

1. 输入64位明文数据，并进行初始置换IP

2. 在初始置换IP后，明文数据再被分为L0和R0左右两部分，每部分32位

3. 在秘钥的控制下，经过16轮运算(f)

4. 16轮后，左、右两部分交换，并连接再一起，再进行逆置换

5. 输出64位密文

>算法过程

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541558188189.png)


----------
### 7. 子密钥生成
>DES算法由64位密钥产生16轮的48位子密钥。主要过程如下：

1. 把密钥的奇偶校验位忽略不参与计算，即每个字节的第8位，将64位密钥降至56位，然后根据选择置换表PC-1将这56位分成两块C0(28位)和D0(28位)

2. 将C0和D0进行循环左移变化(注：每轮循环左移的位数由轮数决定)，变换后生成C1和D1，然后C1和D1合并，并通过选择置换表PC-2生成子密钥K1(48位)

3. C1和D1再次经过循环左移变换，生成C2和D2，然后C2和D2合并，通过选择置换PC-2生成密钥K2(48位)


----------
### 8.加密过程

>数据加密过程将64Bit明文通过密钥加密为密文，主要过程如下：

1. 首先将明文转换为64位的二进制，通过IP表初始**置换，再将其分成L0(32位)和R0(32位)**

2. 把R0通过位选择表E扩展置换，把扩展后的R0和子密钥K1进行异或，得到48位的二进制串。把该串分成8组，每组6位(b1b2b3b4b5b6)

3. 把每组中的b1b6换算为十进制，b2b3b4b5也换算为十进，通**过S盒来收缩**。b1b6代表S盒中的行标，b2b3b4b5代表列标

4. 把压缩后的32位的串通过置换函数P的置换，然后与最初64位的左半边异或，接着开始下一轮

5.通过16轮迭代后，把得到的L15和R15交换位置然后合并得到64位串R15L15，在通过逆置换表IPR得到密文

----------



###  9.DES解密

DES的解密算法与其加密算法使用的算法过程相同。

两者的不同之处在于解密时子密钥Ki的使用顺序与加密时相反，如果子密钥为K1K2…K16,那么解密时子密钥的使用顺序为K16K15…K1,即使用DES解密算法进行解密时，将以64位密文作为输入，第1次迭代运算使用子密钥K16，第2次迭代运算使用子密钥K15，……，第16 次迭代使用子密钥K1，其它的运算与加密算法相同。

这样，最后输出的是64位明文。


----------


##  END

