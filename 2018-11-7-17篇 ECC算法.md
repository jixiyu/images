> 密码学和共识算法  
> 2018年11月7日15:28:16         
> 17 篇  
>made by jixi

### 非对称加密——椭圆曲线算法(ECC)

ECC的主要优势是在某些情况下它比其他的方法使用更小的密钥——比如RSA加密算法——提供相当的或更高等级的安全。

ECC的另一个优势是可以定义群之间的双线性映射，基于Weil对或是Tate对；双线性映射已经在密码学中发现了大量的应用，例如基于身份的加密。

不过一个缺点是加密和解密操作的实现比其他机制花费的时间长。

----------

### 1. 概念
**椭圆曲线密码学（英语：Elliptic curve cryptography，缩写为 ECC）**，一种建立公开密钥加密的算法，基于椭圆曲线数学。椭圆曲线在密码学中的使用是在1985年由Neal Koblitz和Victor Miller分别独立提出的。  

椭圆曲线加密算法(ECC) 是基于椭圆曲线数学的一种公钥加密的算法,随着分解大整数方法的进步以及完善、计算机计算速度的提高以及网络的发展，RSA的使用率越来越高.但是为了安全。其密钥的长度一直保守诟病，于是ECC这种新算法逐步走上了现在加密算法的这个大舞台，其使用率和重要性都在逐年上升.

----------

### 2. 椭圆曲线方程
所谓的椭圆曲线指的是一个齐次方程：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541596604130.png)  

数与形结合,所确定的平面曲线.其中系数ai( i=1,2,3····6)定义在某个域上,是有理数域,也可以是无理数域或者复数域、有限域GF(pr),在ECC这个密码体制里用到的都是定义在有限域上的。

一个叫无穷远点的特殊点和椭圆上的所有的点构成一个集合连同一个定义的加法运算构成一个阿贝尔(Abel)群

曲线上的每个点都必须是非奇异的，所谓的”非奇异”或”光滑”的,在数学中是指曲线上任意一点都存在切线。

等式一：

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541596622617.png)



这个等数中我们能看到已知m和P求点Q很容易,反正只知道Q和点P的情况下求m却是非常困难的,这个问题称为离散对数问题中的椭圆曲线上的点群。  

我们学的椭圆曲线密码体制就是利用以上的这个困难问题来设计的。  

`椭圆曲线的形状,并不是椭圆.是因为椭圆曲线的描述方程,类似于计算一个椭圆的周长的方程得名`。  


----------

### 3. 阿贝尔群是什么?

在数学中,群是一种代数结构,由一个集合以及一个二元运算所组成.如果一个集合或者运算是群的话!就必须满足以下条件  

> 封闭性  
> 
> 结合性  
> 
> 单位元  
> 
> 逆元  

以及满足数学中的定律交换律：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541596859313.png)

在椭圆中任取两个点P和点Q,作直线交于椭圆的一点A,过A做y轴的平行线交于另一点B，有一定义  

![](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541596867046.png)

这样,加法的和也在椭圆上,也满足交换律和结合律。  

由上文既然Able群是所有点和特殊点的和,若有m个相同的点P相加,记做mP,得到等式一:

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541596886893.png)

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541596896831.png)

----------

### 4. 椭圆曲线中的有限域
由上面的介绍,我们已经对椭圆曲线有一定的了解了.但是椭圆是连续的,点和点貌似没有联系如何加密呢？  

给出有限域Fq的描述及其元素的表示,q是一个奇素数 或者是2的次方幂.当q是奇素数p 时，要求p > 2^191；当q 是2的方幂2^m时，要求 m > 192且为素数。  


素域Fp:  

1）当q是奇素数p 时，素域Fp中的元素用整数0;1;2; · · · ; p−1表示。  

a) 加法单位元是整数0；  

b) 乘法单位元是整数1；  

c) 域元素的加法是整数的模p加法，即若a;b ∈  Fp，则a+b = (a+b) mod p；  

d) 域元素的乘法是整数的模p乘法，即若a;b ∈  Fp，则a · b = (a · b) mod p 。  

2）定义在Fp(p是大于3 的素数)上的椭圆曲线方程为：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541596988707.png)

且  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541596994411.png)

椭圆曲线E(Fp)定义为：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541597002488.png)

且满足方程  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541597009438.png)

其中O是无穷远点。  

椭圆曲线E(Fp)上的点的数目用#E(Fq)表示，称为椭圆曲线E(Fp) 的阶。  

 如果椭圆曲线上一点P，存在最小的正整数n，使得数乘 nP=0∞，则将n称为P的阶，若n 不存在，我们说P是无限阶的。  

事实上，在有限域上定义的椭圆曲线上所有的点的阶n都是存在的。  

----------

### 5. secp256k1曲线上公钥和私钥是如何生成的？

1. 用户随机生成一个小于 n 的大整数 k ，这就是私钥。  

2. 然后计算 Q=kG ，这就是公钥（注意，公钥是椭圆曲线上的一个点）。


----------

### 6.公钥私钥怎么用?

假设是用于密钥交换，那么步骤如下（再次提醒一下，这里的乘法是指椭圆曲线上点的乘法）：  

1. 小红生成私钥Ka，将它乘以基点G  得到公钥Qa  

2. 小明生成私钥Kb，将它乘以基点G  得到公钥Qb  

3. 小红计算(xk,yk)=KaQb，xk即为交换得到的密钥。

4. 小明计算(xk,yk)=KbQa ，xk即为交换得到的密钥

 因为 ，所以小红跟小明得到的密钥是相同的。



----------
### 7.密钥协商原理和流程
<b>
 利用模p有限域上椭圆曲线算术规则可以用来实现秘钥协商，其流程如下：  

（1）Alice和Bob会共享一些椭圆曲线的参数信息：(p,a,b,G,n,h)，其中a,b确定了椭圆曲线方程，p确定了模p的有限域，G是中的生成元，用于生成子群，要求G的阶n应该尽量大，G的阶是使得nG=O成立的最小的整数，也即是(n−1)G所代表的点与G点的横坐标刚好相同，协因子h一般等于1。  

（2）Alice选择小于n整数nA，然后计算PA=nA×G，将PA发送给Bob。  

（3）同理，Bob也选择小于n整数nB，然后计算PB=nB×G，将PB发送给Alice。  

（4）Alice通过如下计算得出协商的秘钥：KA=nA×PB；Bob通过如下计算得出协商的秘钥：KB=nB×PB，容易证明，KA=KB。  

因为KA=nA×PB=nA×(nB×G)=nB×(nA×G)=KB。  

由此Alice和Bob计算得到相同的秘钥，达到秘钥协商的目的。  </b>


----------


### 8. 实例

例如，参数a=0,b=−4，椭圆曲线方程为y2=x3−4，p=211,G=(2,2)，因为240G=(2,209)所以n=241。  

Alice选择nA=151，PA=151G=(62,59)；  

Bob选择nB=171，PB=171G=(209,153)；  

他们协商的秘钥K=151PB=171PA=151(209,153)=171(62,59)=(95,194)=(151∗171%n)G=34G。  


----------
### 9.加解密原理和流程
利用椭圆曲线来进行加密和解密也是与RSA一定程度的类似，每一个用户都有属于自己的公钥和私钥。私钥就是用户选定的数字n，私钥自己保存；公钥就是由P=nG，计算出来的点，公钥公开。  

假设Alice与Bob进行加密通信，其加密的流程如下：  
<b>
（1）Alice首先将明文消息转换（编码）为Ep(a,b)中的Pm(x,y)，然后随机选定一个正整数k，并且利用Bob的公钥PB通过如下计算出密文：
Cm={kG,Pm+kPB}  

因此，密文实际上是有两个点组成。  

（2）Bob收到密文Cm，利用自己的私钥nB进行如下计算，可以解密得到明文：
Pm+kPB−nB(kG)=Pm+k(nBG)−nB(kG)=Pm
也就是用第二个点Pm+kPB减去第一个点kG与自己的私钥n之积。
</b>

----------
### 10.


----------


----------


## END 

>2018年11月7日21:10:41

