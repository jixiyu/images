> 密码学和共识算法  
> 2018年11月7日20:29:35         
> 16 篇  
> made by jixi

### 非对称加密——RSA


----------
### 1. RSA概念
1977年，三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，可以实现非对称加密。这种算法用他们三个人的名字命名，叫做RSA算法  

。从那时直到现在，RSA算法一直是最广为使用的"非对称加密算法"。毫不夸张地说，只要有计算机网络的地方，就有RSA算法。  

这种算法非常可靠，密钥越长，它就越难破解。根据已经披露的文献，目前被破解的最长RSA密钥是768个二进制位。也就是说，长度超过768位的密钥，还无法破解（至少没人公开宣布）。因此可以认为，1024位的RSA密钥基本安全，2048位的密钥极其安全。  

下面，我就进入正题，解释RSA算法的原理。文章共分成两部分，今天是第一部分，介绍要用到的四个数学概念。你可以看到，RSA算法并不难，只需要一点数论知识就可以理解。  

----------

### 2. 互质关系
如果两个正整数，除了1以外，没有其他公因子，我们就称这两个数是互质关系（coprime）。比如，15和32没有公因子，所以它们是互质关系。这说明，不是质数也可以构成互质关系。


----------

### 3. 欧拉函数
请思考以下问题：

**任意给定正整数n，请问在小于等于n的正整数之中，有多少个与n构成互质关系？（比如，在1到8之中，有多少个数与8构成互质关系？）**  

计算这个值的方法就叫做欧拉函数，以φ(n)表示。在1到8之中，与8形成互质关系的是1、3、5、7，所以 φ(n) = 4。  

φ(n) 的计算方法并不复杂，但是为了得到最后那个公式，需要一步步讨论。  

**第一种情况**

如果n=1，则 φ(1) = 1 。因为1与任何数（包括自身）都构成互质关系。

**第二种情况**

如果n是质数，则 φ(n)=n-1 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。

**第三种情况**

如果n是质数的某一个次方，即 n = p^k (p为质数，k为大于等于1的整数)，则

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541594070896.png)


比如 φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4。

这是因为只有当一个数不包含质数p，才可能与n互质。而包含质数p的数一共有p^(k-1)个，即1×p、2×p、3×p、...、p^(k-1)×p，把它们去除，剩下的就是与n互质的数。

上面的式子还可以写成下面的形式：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541594103438.png)

可以看出，上面的第二种情况是 k=1 时的特例。

**第四种情况**

如果n可以分解成两个互质的整数之积，

    n = p1 × p2

则

    φ(n) = φ(p1p2) = φ(p1)φ(p2)

即积的欧拉函数等于各个因子的欧拉函数之积。比如，φ(56)=φ(8×7)=φ(8)×φ(7)=4×6=24。


这一条的证明要用到"中国剩余定理"，这里就不展开了，只简单说一下思路：如果a与p1互质(a<p1)，b与p2互质(b<p2)，c与p1p2互质(c<p1p2)，则c与数对 (a,b) 是一一对应关系。由于a的值有φ(p1)种可能，b的值有φ(p2)种可能，则数对 (a,b) 有φ(p1)φ(p2)种可能，而c的值有φ(p1p2)种可能，所以φ(p1p2)就等于φ(p1)φ(p2)。

**第五种情况**

因为任意一个大于1的正整数，都可以写成一系列质数的积。  
![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541594148451.png)


根据第4条的结论，得到  
![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541594153559.png)


再根据第3条的结论，得到  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541594156452.png)

也就等于  
![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541594159246.png)


这就是欧拉函数的通用计算公式。比如，1323的欧拉函数，计算过程如下：  
![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541594163129.png)


----------

### 4. 


----------

### 5. 


----------
## END
<img src="https://www.github.com/jixiyu/images3/raw/master/小书匠/1541557686265.png" width="500" hegiht="500" align="center" /> 
