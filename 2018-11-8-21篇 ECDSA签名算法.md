> 密码学和共识算法  
> 2018年11月8日15:22:29       
> 21 篇  
>made by jixi
> https://www.cnblogs.com/qcblog/p/8998045.html

###  ECDSA签名算法


----------


### 1. 椭圆曲线实现秘钥协商  

1. 原理和流程

 利用模p有限域上椭圆曲线算术规则可以用来实现秘钥协商，其流程如下：  
 

（1）Alice和Bob会共享一些椭圆曲线的参数信息：(p,a,b,G,n,h)，其中a,b确定了椭圆曲线方程，p确定了模p的有限域，G是中的生成元，用于生成子群，要求G的阶n应该尽量大，G的阶是使得nG=O成立的最小的整数，也即是(n−1)G所代表的点与G点的横坐标刚好相同，协因子h一般等于1。  


（2）Alice选择小于n整数nA，然后计算PA=nA×G，将PA发送给Bob。  


（3）同理，Bob也选择小于n整数nB，然后计算PB=nB×G，将PB发送给Alice。  


（4）Alice通过如下计算得出协商的秘钥：KA=nA×PB；Bob通过如下计算得出协商的秘钥：KB=nB×PB，容易证明，KA=KB。  


因为KA=nA×PB=nA×(nB×G)=nB×(nA×G)=KB。  


由此Alice和Bob计算得到相同的秘钥，达到秘钥协商的目的。  


2. 实例

例如，参数a=0,b=−4，椭圆曲线方程为y2=x3−4，p=211,G=(2,2)，因为240G=(2,209)所以n=241。  


Alice选择nA=151，PA=151G=(62,59)；  


Bob选择nB=171，PB=171G=(209,153)；  


他们协商的秘钥K=151PB=171PA=151(209,153)=171(62,59)=(95,194)=(151∗171%n)G=34G。  

----------

### 2. 椭圆曲线实现加解密  

1. 原理和流程  


利用椭圆曲线来进行加密和解密也是与RSA一定程度的类似，每一个用户都有属于自己的公钥和私钥。私钥就是用户选定的数字n，私钥自己保存；公钥就是由P=nG，计算出来的点，公钥公开。  


假设Alice与Bob进行加密通信，其加密的流程如下：  


（1）Alice首先将明文消息转换（编码）为Ep(a,b)中的Pm(x,y)，然后随机选定一个正整数k，并且利用Bob的公钥PB通过如下计算出密文：  
Cm={kG,Pm+kPB}  

因此，密文实际上是有两个点组成。  


（2）Bob收到密文Cm，利用自己的私钥nB进行如下计算，可以解密得到明文：  


Pm+kPB−nB(kG)=Pm+k(nBG)−nB(kG)=Pm  

也就是用第二个点Pm+kPB减去第一个点kG与自己的私钥n之积。  


2. 实例  
3. 

 考虑参数a=0,b=−4,p=199,G=(2,2)，椭圆曲线方程为y2=x3−4，  


Bob选定的私钥为nB=119，其公钥PB=119G=(183,173)。  


Alice希望将消息Pm=(76,66)加密后发送给Bob，于是Alice随机选定正整数k=133，并通过Bob的公钥加密得到密文：  


Cm={133(2,2),(76,66)+133(183,173)}={(40,147),(180,163)}  

Bob收到密文消息利用自己的私钥nB=119进行解密：  


Pm+kPB−nB(kG)=(180,163)−119(40,147)=(180,163)−(98,52)=(76,66)=Pm.  


由此，Bob顺利解密得到明文消息，Alice与Bob之间完成加密通信。  


----------



----------
## END

