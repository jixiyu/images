> 密码学和共识算法  
> 2018年11月8日15:22:29       
> 21 篇  
>made by jixi

###  ECDSA签名算法


----------


### 1. 椭圆曲线实现秘钥协商  

1. 原理和流程

 利用模p有限域上椭圆曲线算术规则可以用来实现秘钥协商，其流程如下：  
 

（1）Alice和Bob会共享一些椭圆曲线的参数信息：(p,a,b,G,n,h)，其中a,b确定了椭圆曲线方程，p确定了模p的有限域，G是中的生成元，用于生成子群，要求G的阶n应该尽量大，G的阶是使得nG=O成立的最小的整数，也即是(n−1)G所代表的点与G点的横坐标刚好相同，协因子h一般等于1。  


（2）Alice选择小于n整数nA，然后计算PA=nA×G，将PA发送给Bob。  


（3）同理，Bob也选择小于n整数nB，然后计算PB=nB×G，将PB发送给Alice。  


（4）Alice通过如下计算得出协商的秘钥：KA=nA×PB；Bob通过如下计算得出协商的秘钥：KB=nB×PB，容易证明，KA=KB。  


因为KA=nA×PB=nA×(nB×G)=nB×(nA×G)=KB。  


由此Alice和Bob计算得到相同的秘钥，达到秘钥协商的目的。  


2. 实例

例如，参数a=0,b=−4，椭圆曲线方程为y2=x3−4，p=211,G=(2,2)，因为240G=(2,209)所以n=241。  


Alice选择nA=151，PA=151G=(62,59)；  


Bob选择nB=171，PB=171G=(209,153)；  


他们协商的秘钥K=151PB=171PA=151(209,153)=171(62,59)=(95,194)=(151∗171%n)G=34G。  

----------

### 2. 


----------

### 3. 


----------

### 4. 


----------

### 5. 


<img src="https://www.github.com/jixiyu/images3/raw/master/小书匠/1541557686265.png" width="500" hegiht="500" align="center" /> 

----------
## END

