> 密码学和共识算法  
> 2018年11月7日14:05:11       
> 14 篇  
> made by jixi
### 对称加密——AES

----------


### 1. 产生原因
1997年1月2号，美国国家标准技术研究所（National Institute of Standards and Technology: NIST）宣布希望征集高级加密标准（Advanced Encryption Standard: AES）[3]，用以取代DES。AES得到了全世界很多密码工作者的响应，先后有很多人提交了自己设计的算法。最终有5个候选算法进入最后一轮：Rijndael，Serpent，Twofish，RC6和MARS，

下图分别为其中的5位作者。最终经过安全性分析、软硬件性能评估等严格的步骤，**Rijndael算法获胜。**

<img src="https://www.github.com/jixiyu/images3/raw/master/小书匠/1541573223422.png" width="500" hegiht="400" align="center" /> 


----------

### 2. 概念
Rijndael由比利时两位非常著名的密码学家**Joan Daemen和Vincent Rijmen设计**。

Rijndael是一个分组密码算法族，其分组长度包括128比特、160比特、192比特、224比特、256比特，密钥长度也包括这五种长度，但是最终AES只选取了分组长度为128比特，密钥长度为128比特、192比特和256比特的三个版本。 

本文主要结合AES-128进行介绍，AES-196和AES-256的思路基本一样，只是密钥扩展算法的过程会稍有不同，加解密的轮数会适当增加，但加解密的操作都是一样的。

AES是一个分组密码，属于对称密码范畴，AES算法的模块在对称密码领域特别是分组密码领域常有使用。

  
----------
### 3. 算法
AES加密算法涉及4种操作：
**字节替代（SubBytes）、行移位（ShiftRows）、列混淆（MixColumns）和轮密钥加（AddRoundKey）**。

下图给出了AES加解密的流程，从图中可以看出：

**1）解密算法的每一步分别对应加密算法的逆操作  
2）加解密所有操作的顺序正好是相反的。**

正是由于这几点（再加上加密算法与解密算法每步的操作互逆）保证了算法的正确性。加解密中每轮的密钥分别由种子密钥经过密钥扩展算法得到。算法中16字节的明文、密文和轮子密钥都以一个4x4的矩阵表示。

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541574439881.png)

----------

### 4. 加密过程

和DES一样，Rijindael算法也是有多个轮所构成的。

DES使用Feistel网络作为其基本结构，而Rijindael没有使用FEistel网络，而是使用了**SPN结构。**

1. Rijindael的输入分组为128比特，也就是16字节。首先，需要逐个字节地对16字节的输入数据进行**SubBytes**处理。所谓**SubBytes，也就是以每个字节的值(0~255中的任意值)为索引，从一张拥有256个值得替换表(S-Box)中查找出对应的处理，也就是说，将一个1字节的值替换成另一个1字节的值。**
 
2. SubBytes之后需要进行**ShiftRows**处理，即对一个4字节的值进行比特运算，将其变成另外一个4字节值。

3. 最后，需要将**MixColumns**的输出与轮密进行XOR，即进行**AddRoundKey**处理。到这里，RijindaeldRijindael的一轮就结束了。实际上，在Rijindael中需要重复进行10~14论计算。



![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541574806070.png)
----------

### 5. 解密过程
从图中我们可以看出，**SubBytes、ShiftRows、MixColumns**分别存在反向运算**InvSubBytes、InvShiftRows、InnvMixColumns**,这事因为Rijndale不像Feistel网络一样能够用同一种结构实现加密与解密。

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1541574764414.png)


----------


### 6. AES优点

1. 和每一轮都只加密一般输入的比特的Feistel网络相比，这种优势在于加密所需要的轮数更少。

2. 此外，这种方式还有一个优势，即SubBytes、ShiftRows和MixColumns可以分别按字节、行、列为单位进行并行计算。
3. 
----------
## END

