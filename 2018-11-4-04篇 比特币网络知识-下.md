> 链-比特币  
> 2018年11月04日 15时34分58秒 
> 04 篇  

### 比特币网络(bitcoin network) -下


----------


### 1. 背景
在引入SPV节点/轻量级节点后不久，比特币开发人员就添加了一个新功能：**Bloom过滤器，用以解决SPV节点的隐私风险问题**。Bloom过滤器通过一个采用概率而不是固定模式的过滤机制，**允许SPV节点只接收交易信息的子集，同时不会精确泄露哪些是它们感兴趣的地址。**


----------
### 2. Bloom过滤器
1. Bloom过滤器是一个允许用户描述特定的关键词组合而不必精确表述的基于概率的过滤方法。
2. 它能让用户在有效搜索关键词的同时保护他们的隐私。在SPV节点里，这一方法被用来向对等节点发送交易信息查询请求，同时交易地址不会被 暴露。
3. 用我们之前的例子，一位手中没有地图的游客需要询问去特定地方的路线。如果他向陌生人询问“教堂街23号在哪里”， 不经意之间，他就暴露了自己的目的地。Bloom过滤器则会这样问，附近有带‘堂’字的街道吗？”这样的问法包含了比之前略少的关键词。这位游客可以自己选择包含信息的多少，比如“以‘堂街’结尾”或者“‘教’字开头的街道”。如果他问得越少，得到了更多可能的地址，隐私得到了保护，但这些地址里面不乏无关的结果；如果他问得非常具体，他在得到较准确的结果的同时也暴露了自己的隐私。
4. Bloom过滤器可以让SPV节点指定交易的搜索模式，该搜索模式可以基于准确性或私密性的考虑被调节。一个非常具体 的Bloom过滤器会生成更准确的结果，但也会显示该用户钱包里的使用的地址；反之，如果过滤器只包含简单的关键 词，更多相应的交易会被搜索出来，在包含若干无关交易的同时有着更高的私密性。
举例：我喜欢一个173的女孩。


----------
### 3. Bloom过滤器如何工作
1. Bloom过滤器的实现是由一个可变长度（N）的二进制数组（N位二进制数构成一个位域）和数量可变（M）的一组哈希函数组成。
2. 这些哈希函数的输出值始终在1和N之间，该数值与二进制数组相对应。并且该函数为确定性函数，也就是说任何一个使用相同Bloom过滤器的节点通过该函数都能对特定输入得到同一个的结果。
3. Bloom过滤器的准确性和私密 性能通过改变长度（N）和哈希函数的数量（M）来调节。
4. 