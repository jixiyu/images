> 生活日常  
> 2018年11月24日10:12:07         
> 5 篇  
>made by jixi  

### Docker command


----------

+ 官网：[https://www.docker.com/](https://www.docker.com/)  

+ 官网的镜像仓库地址[：https://store.docker.com/](https://store.docker.com/)  

+ 玩法理念：单进程，一个容器最好最专注去做一个事情。虽然它可以既装 MySQL，又装 Nginx 等等，但是让一个容器只做好一件事是最合适的。  

+ 阿里云：[https://dev.aliyun.com/search.html](https://dev.aliyun.com/search.html)



----------
### 一、远程处理

1. 启动docker  

``` thrift
systemctl start docker.service
```
2. 停止docker  

```systemctl stop docker.service```

3. 查看运行状态  

```
systemctl status docker.service
```

4. 简单运行某个镜像  

```
sudo docker run hello-world
```
5. 可以代表一个完整的镜像名有两种方式：  
+ REPOSITORY(仓库):TAG(标签):其中 TAG 表面上不是必须有的，本质是 docker 帮你用 latest 来代替了。latest 这里最好翻译为默认，而不是最新。  
* IMAGE ID(镜像ID):这是一个 Docker 随机给你生成 数字+字母 的字符串  

6. docker官网文档  [https://docs.docker.com/engine/reference/run/](https://docs.docker.com/engine/reference/run/)  

7. 查看docker版本  
```
docker version
```
8. 显示docker系统的信息  
```
docker info
```
9. 从仓库下载镜像到本地  
```
docker pull centos:latest： 获取 CentOS 默认版本镜像  
docker pull centos:7.3.1611：获取 CentOS 7 镜像，下载大小 70M 左右，下面的操作基于此镜像  
```
10. 将一个镜像 push 到 registry 仓库中  
```
docker push myapache:v1
```
11. 从 registry 仓库搜索镜像  
```
docker search -s 3 centos，参数 -s 数字：表示筛选出收藏数（stars值）大于等于 3 的镜像
```


----------
### 二、本地镜像管理

1. 查看当前启动的容器各自占用的系统资源  
```
docker stats  
bin docker stats –no-stream kafkadocker_kafka_1 kafkadocker_zookeeper_1：查看指定容器的占用资源情况
```
2. 显示本地所有的镜像列表  
```
docker images：关注 REPOSITORY(名称)，TAG(标签)，IMAGE ID(镜像ID)三列
```
3. 删除镜像  
```
docker rmi：删除镜像，一般删除镜像前要先删除容器，不然如果镜像有被容器调用会报错

docker rmi 容器ID：删除具体某一个镜像  

docker rmi 仓库:Tag：删除具体某一个镜像  

docker rmi $(docker images -q)，删除所有镜像  

docker rmi -f $(docker images -q)，强制删除所有镜像  


```
4. 为镜像打上标签  
```
docker tag  、
docker tag -f ubuntu:14.04 ubuntu:latest，-f 意思是强制覆盖  
同一个IMAGE ID可能会有多个TAG（可能还在不同的仓库），首先你要根据这些 image names 来删除标签，当删除最后一个tag的时候就会自动删除镜像；  
```
5. 使用 Dockerfile 创建镜像（推荐）  
```
docker build  
docker build . –rm -t runoob/ubuntu:v1，参数 -t，表示：-tag，打标签  
```
6. 显示生成一个镜像的历史命令  
```
docker history：显示生成一个镜像的历史命令，可以看出这个镜像的构建过程，包括：每一层镜像的 ID、指令  
```
7. 将一个镜像保存为一个 tar 包  
```
docker save：将一个镜像保存为一个 tar 包，带 layers 和 tag 信息（导出一个镜像）  

docker save 镜像ID -o /opt/test.tar  
```
8. 导入一个镜像  
```
docker load：从一个 tar 包创建一个镜像（导入一个镜像）  

docker load -i /opt/test.tar  


```


----------
### 三、容器生命周期管理  

1. docker run，运行镜像  
```
docker run -v /java_logs/:/opt/ -d -p 8080:80 –name myDockerNameIsGitNavi -i -t 镜像ID /bin/bash  

-i -t 分别表示保证容器中的 STDIN 开启，并分配一个伪 tty 终端进行交互，这两个是合着用。  

–name 是给容器起了一个名字（如果没有主动给名字，docker 会自动给你生成一个）容器的名称规则：大小写字母、数字、下划线、圆点、中横线，用正则表达式来表达就是：[a-zA-Z0-9_*-]  

-d 容器运行在后台。  

-p 8080:80 表示端口映射，将宿主机的8080端口转发到容器内的80端口。（如果是 -P 参数，则表示随机映射应该端口，一般用在测试的时候）  

-v /java_logs/:/opt/ 表示目录挂载，/java_logs/ 是宿主机的目录，/opt/ 是容器目录  
```
2.   
```

```
3.   
```

```
4.   
```

```
5.   
```

```
6.   
```

```
7.   
```

```
8.   
```

```
9.   
```

```


----------

## END

