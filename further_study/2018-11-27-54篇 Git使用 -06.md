> further study  
> 2018年11月27日17:36:22         
> 54 篇  
>made by jixi  

### Git使用


----------

1. git init  

这个时候用到了第一个命令，代表初始化 git 仓库，输入 git init 之后会提示：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543311484080.png)

可以看到初始化成了，至此 test 目录已经是一个 git 仓库了。  

2. git status  

紧接着我们输入 git status 命令，会有如下提示：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543311575885.png)

默认就直接在 master 分支，关于分支的概念后面会提，这时最主要的是提示 a.md 文件 Untracked files ，就是说 a.md 这个文件还没有被跟踪，还没有提交在 git 仓库里呢，而且提示你可以使用 git add <file> 去操作你想要提交的文件。  


git status 这个命令顾名思义就是查看状态，这个命令可以算是使用最频繁的一个命令了，建议大家没事就输入下这个命令，来查看你当前 git 仓库的一些状态。  

3. git add  


上面提示 a.md 文件还没有提交到 git 仓库里，这个时候我们可以随便编辑下 a.md 文件，然后输入 git add a.md ，然后再输入 git status :  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543311641403.png)

此时提示以下文件 Changes to be committed ， 意思就是 a.md 文件等待被提交，当然你可以使用 git rm --cached 这个命令去移除这个缓存。  

4. git commit  


接着我们输入 git commit -m 'first commit' ，这个命令什么意思呢？ commit 是提交的意思，-m 代表是提交信息，执行了以上命令代表我们已经正式进行了第一次提交。  


这个时候再输入 git status ，会提示 nothing to commit。  


5. git log  


这个时候我们输入 git log 命令，会看到如下：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543311753479.png)

git log 命令可以查看所有产生的 commit 记录，所以可以看到已经产生了一条 commit 记录，而提交时候的附带信息叫 'first commit' 。  


6. git add & git commit


看到这里估计很多人会有疑问，我想要提交直接进行 commit 不就行了么，为什么先要再 add 一次呢？首先 git add 是先把改动添加到一个「暂存区」，你可以理解成是一个缓存区域，临时保存你的改动，而 git commit 才是最后真正的提交。这样做的好处就是防止误提交，当然也有办法把这两步合并成一步，不过后面再介绍，建议新手先按部就班的一步步来。  


7. git branch  


branch 即分支的意思，分支的概念很重要，尤其是团队协作的时候，假设两个人都在做同一个项目，这个时候分支就是保证两人能协同合作的最大利器了。举个例子，A, B俩人都在做同一个项目，但是不同的模块，这个时候A新建了一个分支叫a， B新建了一个分支叫b，这样A、B做的所有代码改动都各自在各自的分支，互不影响，等到俩人都把各自的模块都做完了，最后再统一把分支合并起来。  


执行 git init 初始化git仓库之后会默认生成一个主分支 master ，也是你所在的默认分支，也基本是实际开发正式环境下的分支，一般情况下 master 分支不会轻易直接在上面操作的，你们可以输入 git branch 查看下当前分支情况：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543311801330.png)

如果我们想在此基础上新建一个分支呢，很简单，执行 git branch a 就新建了一个名字叫 a 的分支，这时候分支 a 跟分支 master 是一模一样的内容，我们再输入 git branch 查看的当前分支情况：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543311814443.png)

但是可以看到 master 分支前有个 * 号，即虽然新建了一个 a 的分支，但是当前所在的分支还是在 master 上，如果我们想在 a 分支上进行开发，首先要先切换到 a 分支上才行，所以下一步要切换分支  


8. git checkout a  


执行这个命令，然后再输入 git branch 查看下分支情况：  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543311859389.png)

可以看到当前我们在的分支已经是a了，这个时候 A 同学就可以尽情的在他新建的a分支去进行代码改动了。  


那有人就说了，我要先新建再切换，未免有点麻烦，有没有一步到位的，聪明：  


9. git checkout -b a


这个命令的意思就是新建一个a分支，并且自动切换到a分支。  


10. git merge


A同学在a分支代码写的不亦乐乎，终于他的功能完工了，并且测试也都ok了，准备要上线了，这个时候就需要把他的代码合并到主分支master上来，然后发布。git merge 就是合并分支用到的命令，针对这个情况，需要先做两步，第一步是切换到 master 分支，如果你已经在了就不用切换了，第二步执行 git merge a ，意思就是把a分支的代码合并过来，不出意外，这个时候a分支的代码就顺利合并到 master 分支来了。为什么说不出意外呢？因为这个时候可能会有冲突而合并失败，留个包袱，这个到后面进阶的时候再讲。  


11. git branch -d


有新建分支，那肯定有删除分支，假如这个分支新建错了，或者a分支的代码已经顺利合并到 master 分支来了，那么a分支没用了，需要删除，这个时候执行 git branch -d a 就可以把a分支删除了。


12. git branch -D


有些时候可能会删除失败，比如如果a分支的代码还没有合并到master，你执行 git branch -d a 是删除不了的，它会智能的提示你a分支还有未合并的代码，但是如果你非要删除，那就执行 git branch -D a 就可以强制删除a分支。  


13. git tag


我们在客户端开发的时候经常有版本的概念，比如v1.0、v1.1之类的，不同的版本肯定对应不同的代码，所以我一般要给我们的代码加上标签，这样假设v1.1版本出了一个新bug，但是又不晓得v1.0是不是有这个bug，有了标签就可以顺利切换到v1.0的代码，重新打个包测试了。  


所以如果想要新建一个标签很简单，比如 git tag v1.0 就代表我在当前代码状态下新建了一个v1.0的标签，输入 git tag 可以查看历史 tag 记录。  

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543312000142.png)

可以看到我新建了两个标签 v1.0、v1.1。  


想要切换到某个tag怎么办？也很简单，执行 git checkout v1.0 ，这样就顺利的切换到 v1.0 tag的代码状态了。  


OK，以上全是一些最基本的Git操作，而且全是在本地环境进行操作的，完全没有涉及到远程仓库，下一章节将以远程 GitHub 仓库为例，讲解下本地如何跟远程仓库一起同步协作，另外今天讲的全是最基础最简单的Git操作，一步步来，后续再继续讲解一下Git的高阶以及一些Git的酷炫操作。  


----------
> https://zhuanlan.zhihu.com/p/22666153  

使用git在本地创建一个项目的过程  

``` javascript
$ mkdir ~/hello-world    //创建一个项目hello-world
$ cd ~/hello-world       //打开这个项目
$ git init             //初始化 
$ touch README
$ git add README        //更新README文件
$ git commit -m 'first commit'     //提交更新，并注释信息“first commit”
$ git remote add origin git@github.test/hellotest.git     //连接远程github项目  
$ git push -u origin master     //将本地项目更新到github项目上去
```

git设置关闭自动换行  

``` shell
$ git config --global core.autocrlf false 
```

为了保证文件的换行符是以安全的方法，避免windows与unix的换行符混用的情况，最好也加上这么一句   

``` shell
$ git config --global core.safecrlf true
```


git tag 使用  

``` crmsh
git tag  # 列出当前仓库的所有标签
git tag -l 'v0.1.*'  # 搜索符合当前模式的标签
git tag v0.2.1-light  # 创建轻量标签
git tag -a v0.2.1 -m '0.2.1版本'  # 创建附注标签
git checkout [tagname]  # 切换到标签
git show v0.2.1  # 查看标签版本信息
git tag -d v0.2.1  # 删除标签
git tag -a v0.2.1 9fbc3d0  # 补打标签
git push origin v0.1.2  # 将v0.1.2标签提交到git服务器
git push origin --tags  # 将本地所有标签一次性提交到git服务器
git tag  # 查看当前分支下的标签
```

git pull问题  

``` sql
You asked me to pull without telling me which branch you
want to merge with, and 'branch.content_api_zhangxu.merge' in
your configuration file does not tell me, either. Please
specify which branch you want to use on the command line and
try again (e.g. 'git pull <repository> <refspec>').
See git-pull(1) for details.
If you often merge with the same branch, you may want to
use something like the following in your configuration file:
    [branch "content_api_zhangxu"]
    remote = <nickname>
    merge = <remote-ref>
    [remote "<nickname>"]
    url = <url>
    fetch = <refspec>See git-config(1) for details.
git pull origin new_branch
```


怎样遍历移除项目中的所有 .pyc 文件  

``` sqf
sudo find /tmp -name "*.pyc" | xargs rm -rf
```

替换/tmp目录为工作目录   

``` nginx
git rm *.pyc
```

这个用着也可以  

避免再次误提交，在项目新建.gitignore文件，输入*.pyc过滤文件  



git变更项目地址

``` dsconfig
git remote set-url origin git@192.168.6.70:res_dev_group/test.git 
git remote -v
```

查看某个文件的修改历史  

``` applescript
git log --pretty=oneline 文件名 # 显示修改历史 
git show 356f6def9d3fb7f3b9032ff5aa4b9110d4cca87e # 查看更改
```


git push 时报错 warning: push.default is unset

![enter description here](https://www.github.com/jixiyu/images3/raw/master/小书匠/1543313223591.png)

‘matching’ 参数是 Git 1.x 的默认行为，其意是如果你执行 git push 但没有指定分支，它将 push 所有你本地的分支到远程仓库中对应匹配的分支。而 Git 2.x 默认的是 simple，意味着执行 git push 没有指定分支时，只有当前分支会被 push 到你使用 git pull 获取的代码。 
根据提示，修改git push的行为:   

``` fsharp
git config –global push.default matching 
```

再次执行git push 得到解决  



git submodule的使用拉子项目代码  

开发过程中，经常会有一些通用的部分希望抽取出来做成一个公共库来提供给别的工程来使用，而公共代码库的版本管理是个麻烦的事情。今天无意中发现了git的git submodule命令，之前的问题迎刃而解了。  

添加  

为当前工程添加submodule，命令如下：  

``` armasm
git submodule add 仓库地址 路径
```

其中，仓库地址是指子模块仓库地址，路径指将子模块放置在当前工程下的路径。   
注意：路径不能以 / 结尾（会造成修改不生效）、不能是现有工程已有的目录（不能順利 Clone）  

命令执行完成，会在当前工程根路径下生成一个名为“.gitmodules”的文件，其中记录了子模块的信息。添加完成以后，再将子模块所在的文件夹添加到工程中即可。  

删除  

submodule的删除稍微麻烦点：首先，要在“.gitmodules”文件中删除相应配置信息。然后，执行git rm –cached命令将子模块所在的文件从git中删除。  

下载的工程带有submodule  

当使用git clone下来的工程中带有submodule时，初始的时候，submodule的内容并不会自动下载下来的，此时，只需执行如下命令：  

``` jboss-cli
git submodule update --init --recursive
```

即可将子模块内容下载下来后工程才不会缺少相应的文件。  





----------
## END

